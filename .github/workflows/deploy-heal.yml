# 1. Build and Start Services using Compose
      - name: Deploy with Compose
        run: |
          echo "Starting App and Database..."
          # REMOVED THE HYPHEN BELOW
          docker compose up -d --build
          
          echo "Waiting for services to stabilize..."
          sleep 15 

      # 2. Health Check & Auto-Healing Logic
      - name: Health Check and Auto-Heal
        run: |
          echo "Checking Health Endpoint..."
          
          STATUS_CODE=$(curl -o /dev/null -s -w "%{http_code}\n" http://localhost:5000/health)
          
          if [ "$STATUS_CODE" == "200" ]; then
            echo "✅ Health Check Passed! Database is connected."
            exit 0
          else
            echo "❌ Health Check FAILED (Status: $STATUS_CODE). Attempting Healing..."
            
            # --- HEALING PROCESS ---
            echo "1. Restarting the Web Container..."
            # REMOVED THE HYPHEN BELOW
            docker compose restart web
            
            echo "Waiting for restart..."
            sleep 10
            
            # Re-check health
            RETRY_STATUS=$(curl -o /dev/null -s -w "%{http_code}\n" http://localhost:5000/health)
            
            if [ "$RETRY_STATUS" == "200" ]; then
               echo "✅ Healing Successful! App is back online."
               exit 0
            else
               echo "❌ Healing Failed. Rolling back everything..."
               # REMOVED THE HYPHEN BELOW
               docker compose down
               exit 1
            fi
          fi